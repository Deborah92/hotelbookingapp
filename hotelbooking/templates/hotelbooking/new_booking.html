{% extends 'app/base.html' %}

{% block content %}
    {% load i18n %}
    <h1>{% trans 'WelcomeHeading' %}</h1>

    <div class="">
        <div class="title-div">
            <h3 class="w70" >Create Booking</h3>
        </div>
        <div class="margin2">
        
            <form action="{% url 'get_room_types_available' %}" method="get">
                <div id="search-bar" >
                    <div class="form-group row mr-2 fit-content">
                        <label class="col-sm-4 col-form-label label-search">In - Out:</label>
                        <div class="col-sm-8">
                            <input type="text" name="in_out_range" class="form-control" required />
                        </div>
                    </div>
                    <div class="form-group row mr-2 fit-content">
                        <label class="col-sm-7 col-form-label label-search">Num guests:</label>
                        <div class="col-sm-5">
                            <input type="number" class="form-control" name="num_guests" min="1" max="4" value={{num_guests}} required />
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary fit-content align-items-center">Search</button>
                </div>
            </form>
            
            
                {% for room_type in room_types_available %}
                    <form action="{% url 'booking_contact_data' %}" method="get">
                        <div class= "card-booking">
                            <div id="align-items-card" class="d-flex">
                                <span>{{ room_type.name }}</span>
                                <span id="occupancy-icon"><i class="fa-solid fa-user-large"></i>{{ room_type.max_guest }}</span>
                                <span>{{ room_type.total }}â‚¬</span>
                            </div>
                            
                            <button type="submit" class="btn btn-primary">Select</a>
                        </div> 
                        <input type="hidden" name="room_type" value={{room_type.id}} required >
                        <input type="hidden" name="in_out_range" value={{in_out_range}} class="form-control" required />
                        <input type="hidden" name="num_guests" min="1" max="4" value={{num_guests}} required >
                        <input type="hidden" name="total" value={{room_type.total}} >
                    </form>
                {% endfor %}
                {% if not room_types_available %}
                    No hay habitaciones disponibles
                {% endif %}
        </div>
    </div>

    
    <script type="text/javascript">
         
        $(function() {
            $('input[name="in_out_range"]').daterangepicker({
                opens: 'left',
                startDate: moment("{{in_date}}" || moment(), 'YYYY-MM-DD'),
                endDate: moment("{{out_date}}" || moment().startOf('hour').add(24, 'hour'), 'YYYY-MM-DD'),
                minDate: moment(),
                maxDate: moment().endOf('year'),
                locale: {
                    format: 'YYYY-MM-DD'
                }
            }, function(start, end, label) {
                console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
            });
        });
    </script>
{% endblock %}

